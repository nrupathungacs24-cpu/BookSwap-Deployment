<div id="bookDetailsModal" tabindex="-1"
    class="fixed top-0 left-0 p-4 flex items-center justify-center z-50 w-full overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%)] max-h-full backdrop-blur-md bg-black/30">
    <div class="relative w-full max-w-4xl max-h-[90vh] overflow-y-auto">
        <!-- Modal content -->
        <div class="relative bg-white rounded-xl shadow-2xl border border-gray-100 overflow-hidden">
            <!-- Close Button -->
            <button type="button"
                class="absolute top-4 right-4 z-10 bg-white/80 backdrop-blur-sm rounded-full text-sm w-10 h-10 inline-flex justify-center items-center shadow-md hover:bg-gray-100 transition-colors"
                (click)="closeModal()">
                <i class="fa-solid fa-xmark fa-lg text-gray-500 hover:text-gray-900"></i>
                <span class="sr-only">Close modal</span>
            </button>

            <!-- Modal header & body combine for Amazon style -->
            <div class="flex flex-col md:flex-row p-6 md:p-10 gap-8">
                <!-- Left Column: Image -->
                <div class="w-full md:w-1/3 flex justify-center items-start">
                    <div class="sticky top-0 shadow-lg rounded-lg overflow-hidden border border-gray-200">
                        <img class="w-full h-auto object-cover"
                            [src]="bookDetails?.volumeInfo?.imageLinks?.thumbnail || 'assets/no-book-cover.png'"
                            alt="{{ bookDetails?.volumeInfo?.title }} Image" />
                    </div>
                </div>

                <!-- Right Column: Details & Actions -->
                <div class="w-full md:w-2/3 flex flex-col">
                    <div class="border-b pb-4 mb-4">
                        <h3 class="text-3xl font-bold text-gray-900 mb-2">{{ bookDetails?.volumeInfo?.title }}</h3>
                        <p class="text-xl text-[#0DBE5E] font-medium mb-1">
                            by {{ bookDetails?.volumeInfo?.authors?.join(', ') || 'Unknown Author' }}
                        </p>
                        <div class="flex items-center gap-4 text-sm text-gray-500">
                            <span>{{ bookDetails?.volumeInfo?.publisher }}</span>
                            <span>â€¢</span>
                            <span>{{ bookDetails?.volumeInfo?.publishedDate }}</span>
                        </div>
                    </div>

                    <!-- Owner Info Section -->
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-100 mb-6">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <img [src]="ownerAvatarUrl" alt="avatar"
                                    class="w-12 h-12 rounded-full border-2 border-white shadow-sm object-cover" />
                                <div>
                                    <p class="text-xs text-gray-500 uppercase font-bold tracking-wider">Book Owner</p>
                                    <h2 class="text-gray-900 font-semibold">{{ ownerUsername }}</h2>
                                </div>
                            </div>
                            <button
                                class="bg-[#0DBE5E]/10 text-[#0DBE5E] px-4 py-2 rounded-lg text-sm font-semibold hover:bg-[#0DBE5E]/20 transition-all flex items-center gap-2"
                                (click)="viewUser()">
                                View Profile
                                <i class="fa-solid fa-arrow-up-right-from-square text-xs"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Interest Action Section (Amazon style) -->
                    <div class="space-y-4 mb-6">
                        <button (click)="expressedInterest()" [disabled]="isInterestedLoading"
                            class="w-full bg-[#FFD814] hover:bg-[#F7CA00] text-black py-4 rounded-full font-bold shadow-sm transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed">
                            <i class="fa-solid fa-heart" [class.fa-beat]="isInterestedLoading"></i>
                            {{ isInterestedLoading ? 'Processing...' : "I'm Interested" }}
                        </button>
                        <p class="text-xs text-center text-gray-500">
                            Clicking interest will notify the owner and start a chat.
                        </p>
                    </div>

                    <!-- Description Section -->
                    <div class="prose prose-sm max-w-none text-gray-600">
                        <h4 class="text-gray-900 font-bold mb-2">Description</h4>
                        <p class="leading-relaxed">{{ bookDetails?.volumeInfo?.description || 'No description available
                            for this book.' }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>